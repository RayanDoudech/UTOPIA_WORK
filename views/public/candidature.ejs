<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= title %></title>
    <link href='https://unpkg.com/boxicons@2.0.9/css/boxicons.min.css' rel='stylesheet'>
    <link rel="stylesheet" href="/css/bootstrap.min.css" />
    <link rel='stylesheet' href='/stylesheets/sidebar.css' />
    <link rel='stylesheet' href='/stylesheets/organisation/offre-creation.css' />
    <script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>
    <script src="/js/libs/jquery.js"></script>
    <script src="/js/libs/swal.js"></script>
    <script src="/js/candidature/candidature.js"></script>
</head>
<body>
<%- include('../sidebar/sidebar', {user: user}); %>
<main>
    <div class="container">
        <div class="card">
            <div class="form" >
                <form class="form" action="" id="candidature_creation_form">
                    <div class="left-side">
                        <div class="left-heading">
                            <h3>UT'OPIA - Org</h3>
                        </div>
                        <div class="steps-content">
                            <h3>Étape <span class="step-number">1</span></h3>
                            <p class="step-number-content active">Informations générale relative à l'offre.</p>
                            <p class="step-number-content d-none">Localisation de la mission.</p>
                            <p class="step-number-content d-none">Vérifiez vos informations personnelles</p>
                            <p class="step-number-content d-none">Votre dossier de candidature</p>
                            <!--<p class="step-number-content d-none">Add your profile piccture and let companies find youy fast.</p>-->
                        </div>
                        <ul class="progress-bar">
                            <li class="active">Informations générales</li>
                            <li>Localisation de la mission</li>
                            <li>Vérifiez vos informations personnelles</li>
                            <li>Votre dossier de candidature</li>
                            <!--<li>User Photo</li>-->
                        </ul>



                    </div>
                    <div class="right-side">
                        <div class="main active">
                            <small><i class="fa fa-smile-o"></i></small>
                            <div class="text">
                                <h2>Informations générale relative à l'offre à laquelle vous candidatez.</h2>
                                <p>Retrouvez ici les informations générale relative à l'offre.</p>
                            </div>
                            <!--candidature-->
                            <input type="text" required require hidden hide id="candidature_uid" name="candidature_uid" disabled value="<%= candidature.candidature_uid%>">
                            <input type="text" required require hidden hide id="offre_uid" name="offre_uid" disabled value="<%= offre.offre_uid%>">
                            <div class="input-text">
                                <span>Intitulé du poste</span>
                                <div class="input-div">
                                    <input type="text" required require id="intitule" name="intitule" disabled value="<%= offre.intitule%>">
                                </div>
                            </div>
                            <div class="input-text">
                                <span>Status du poste</span>
                                <div class="input-div">
                                    <input type="text" require required id="status_poste" name="status_poste" disabled value="<%= offre.status_poste%>">
                                </div>
                            </div>
                            <div class="input-text">
                                <span>Type du métier </span>
                                <div class="input-div">
                                    <input type="text" require id="type" name="type" required disabled value="<%= offre.intitule%>">
                                </div>
                            </div>
                            <div class="input-text">
                                <span>Rythme de la mission</span>
                                <div class="input-div">
                                    <input type="text" require required id="rythme" name="rythme" require disabled value="<%= offre.rythme%>">
                                </div>
                            </div>
                            <div class="input-text">
                                <span>Responsable hiérarchique</span>
                                <div class="input-div">
                                    <input type="text" require id="responsable" name="responsable" disabled value="<%= offre.responsable%>">
                                </div>
                            </div>
                            <div class="input-text">
                                <span>Salaire Annuelle BRUT en €</span>
                                <div class="input-div">
                                    <input type="text" require id="salaire" name="salaire" disabled value="<%= offre.salaire%>">
                                </div>
                            </div>
                            <div class="buttons">
                                <button class="next_button" style="width: 30%">Étape suivante</button>
                            </div>
                        </div>
                        <div class="main">
                            <small><i class="fa fa-smile-o"></i></small>
                            <div class="text">
                                <h2>Localisation</h2>
                                <p>Localisation de la mission.</p>
                            </div>
                            <input type="hidden" name="loc_lat" id="loc_lat" disabled value="<%= offre.lieu_mission_lat%>">
                            <input type="hidden" name="loc_long" id="loc_long" disabled value="<%= offre.lieu_mission_long%>">

                            <!-- prettier-ignore -->
                            <div style="height: 480px" id="map"></div>
                            <script>(g=>{var h,a,k,p="The Google Maps JavaScript API",c="google",l="importLibrary",q="__ib__",m=document,b=window;b=b[c]||(b[c]={});var d=b.maps||(b.maps={}),r=new Set,e=new URLSearchParams,u=()=>h||(h=new Promise(async(f,n)=>{await (a=m.createElement("script"));e.set("libraries",[...r]+"");for(k in g)e.set(k.replace(/[A-Z]/g,t=>"_"+t[0].toLowerCase()),g[k]);e.set("callback",c+".maps."+q);a.src=`https://maps.${c}apis.com/maps/api/js?`+e;d[q]=f;a.onerror=()=>h=n(Error(p+" could not load."));a.nonce=m.querySelector("script[nonce]")?.nonce||"";m.head.append(a)}));d[l]?console.warn(p+" only loads once. Ignoring:",g):d[l]=(f,...n)=>r.add(f)&&u().then(()=>d[l](f,...n))})
                                ({key: "PUT_YOUR_OWN_MAPS_KEY_HERE", v: "beta"});</script>
                            <div class="buttons button_space">
                                <button class="back_button" style="width: 30%">Retour en arrière</button>
                                <button class="next_button" style="width: 30%">Étape suivante</button>
                            </div>
                        </div>
                        <div class="main">
                            <small><i class="fa fa-smile-o"></i></small>
                            <div class="text">
                                <h2>Vérifiez vos informations personnelles</h2>
                                <p>Vérifions ensemble vos informations personnelles avant de les transmettre à l'organisation!</p>
                            </div>
                            <div class="input-text">
                                <span>Nom</span>
                                <div class="input-div">
                                    <input type="text" require id="nom" name="nom" disabled value="<%= user_model.nom.toString().trim()%>">
                                </div>
                            </div>
                            <div class="input-text">
                                <span>Prénom (s)</span>
                                <div class="input-div">
                                    <input type="text" require id="prenom" name="prenom" disabled value="<%= user_model.prenom.toString().trim()%>">
                                </div>
                            </div>
                            <div class="input-text">
                                <span>Adresse e-mail :</span>
                                <div class="input-div">
                                    <input type="text" require id="mail" name="mail" disabled value="<%= user_model.adresse_email.toString().trim()%>">
                                </div>
                            </div>

                            <div class="input-text">
                                <span>N° de téléphone :</span>
                                <div class="input-div">
                                    <input type="text" require id="email" name="email" disabled value="<%= user_model.tel.toString().trim()%>">
                                </div>
                            </div>

                            <p style="font-style: italic">Vérifiez vos informations personnelles, si elles ne sont pas correctes éditez les avant d'envoyer votre candidature !</p>

                            <div class="buttons button_space">
                                <button class="back_button" style="width: 30%">Retour en arrière</button>
                                <button class="next_button" style="width: 30%">Étape suivante</button>
                            </div>
                        </div>
                        <div class="main">
                            <small><i class="fa fa-smile-o"></i></small>
                            <div class="text">
                                <h2>Mon dossier de candidature</h2>
                                <p>Compléter mon dossier de candidature</p>
                            </div>

                            <div class="input-text">
                                <span>Pièces demandés</span>
                                <div class="input-div">
                                    <input type="text" require id="responsable" name="responsable" disabled value="<%= offre.pieces_demandes%>">
                                </div>
                            </div>
                            <% for(let i=0; i < files.length; i++) { %>
                                <div class="input-div button_space" style="margin-bottom: 1rem">
                                    <input type="text" disabled require id="file_to_delete" name="file_to_delete" value="<%= files[i].file_name %>">
                                    <% if (candidature.candidature_status !== 3 && candidature.candidature_status !== 4) {%>
                                        <button onclick="delete_file(<%=files[i].doc_uid%>)" class="btn btn-danger delete_btn" style="width: 70%">Supprimer le fichier</button>
                                    <%}%>
                                </div>
                            <%}%>
                            <% if (candidature.candidature_status === 1) {%>
                                <div class="buttons button_space">
                                    <input type="file" require id="file_to_upload" name="file_to_upload" value="Ajouter un fichier">
                                    <button class="btn btn-success upload_btn" style="width: 30%">Envoyer le fichier</button>
                                </div>
                                <div class="buttons button_space" style="margin-top: 20rem">
                                    <button class="back_button" style="width: 30%">Retour en arrière</button>
                                    <button id="submit_candidature_button" class="submit_candidature_button" style="width: 30%">Envoyer la candidature</button>
                                </div>
                            <%} else {%>
                                <div class="buttons button_space" style="margin-top: 20rem">
                                    <h5>Candidature déjà envoyée !</h5>
                                </div>
                            <%}%>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <p class="copyright">
        &copy; 2023 - <span>SR10 - D.R</span> License <a href="https://github.com/DISIC/design.numerique.gouv.fr/blob/master/LICENSE.md#licence-ouverte-20open-licence-20" target="_blank">OPEN LICENCE 2.0</a>.
    </p>
</main>
</body>
</html>
